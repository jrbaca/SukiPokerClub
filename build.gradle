plugins {
    id "org.jetbrains.kotlin.jvm" version "1.3.61" apply false
    id("org.openjfx.javafxplugin") version "0.0.8" apply false
}

subprojects {
    apply plugin: "org.jetbrains.kotlin.jvm"

    dependencies {
        implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8"
    }

    repositories {
        jcenter()
    }

    sourceCompatibility = 11
    targetCompatibility = 11

    compileKotlin {
        kotlinOptions.jvmTarget = "1.8"
    }
    compileTestKotlin {
        kotlinOptions.jvmTarget = "1.8"
    }

}

project(":core") {
    dependencies {
        compile "io.ktor:ktor-websockets:1.3.1"
    }
}

project(":client") {
    apply plugin: "application"
    apply plugin: "org.openjfx.javafxplugin"

    mainClassName = 'app.SukiPokerClubClientKt'

    javafx {
        version = "13"
        modules = ['javafx.controls', 'javafx.fxml']
    }

    dependencies {
        compile project(":core")
        compile "io.ktor:ktor-websockets:1.3.1"
        implementation "io.ktor:ktor-client-websockets:1.3.1"
        implementation "io.ktor:ktor-client-cio:1.3.1"
    }
}

project(":server") {
    apply plugin: "application"

    mainClassName = 'app.SukiPokerClubServerKt'

    dependencies {
        compile project(":core")
        compile "io.ktor:ktor-server-netty:1.3.1"
        compile "io.ktor:ktor-websockets:1.3.1"
    }

    task packageReleaseJar(type: Jar) {
        manifest {
            attributes 'Main-Class': 'app.SukiPokerClubServer.kt'
        }
        archiveName('server-release.jar')
        from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
        with jar
    }
}